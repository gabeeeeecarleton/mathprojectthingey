<!DOCTYPE html>
<html lang="en">
<head>
     <link rel="stylesheet" href="css/styles.css">
     <link rel="stylesheet" href="css/reset.css">
  <meta charset="utf-8" />
  <title>best matrix thing ever.</title>
<style>#square {
    position: absolute;
    border: 2px solid red;
.element {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
}</style>
</head>
<body>
  <h1>the matrixer.</h1>
  
  <div class="box">
  <p>please enter your matrix below!
  </p>

  <form id="matrixForm" onsubmit="return false;">
  
    <table>
      <tbody>
    
        <tr>
          <td class="row-label">r0</td>
          <td><input type="number" step="any" inputmode="numeric" id="m00" aria-label="row 0 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m01" aria-label="row 0 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m02" aria-label="row 0 column 2" placeholder="0"></td>
        </tr>

        <tr>
          <td class="row-label">r1</td>
          <td><input type="number" step="any" inputmode="numeric" id="m10" aria-label="row 1 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m11" aria-label="row 1 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m12" aria-label="row 1 column 2" placeholder="0"></td>
        </tr>

        <tr>
          <td class="row-label">r2</td>
          <td><input type="number" step="any" inputmode="numeric" id="m20" aria-label="row 2 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m21" aria-label="row 2 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="m22" aria-label="row 2 column 2" placeholder="0"></td>
        </tr>
      </tbody>
    </table>

    <div>
      <button id="readBtn" type="button">do it!</button>
      
      <button id="clearBtn" type="button">clear</button>
      <button id="exampleBtn" type="button">identity</button>
    </div>
  </form>
  
    <p>and a transform..
  </p>
  
  <form id="transForm" onsubmit="return false;">
  
    <table>
      <tbody>
    
        <tr>
          <td class="row-label">r0</td>
          <td><input type="number" step="any" inputmode="numeric" id="t00" aria-label="row 0 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t01" aria-label="row 0 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t02" aria-label="row 0 column 2" placeholder="0"></td>
        </tr>

        <tr>
          <td class="row-label">r1</td>
          <td><input type="number" step="any" inputmode="numeric" id="t10" aria-label="row 1 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t11" aria-label="row 1 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t12" aria-label="row 1 column 2" placeholder="0"></td>
        </tr>

        <tr>
          <td class="row-label">r2</td>
          <td><input type="number" step="any" inputmode="numeric" id="t20" aria-label="row 2 column 0" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t21" aria-label="row 2 column 1" placeholder="0"></td>
          <td><input type="number" step="any" inputmode="numeric" id="t22" aria-label="row 2 column 2" placeholder="0"></td>
        </tr>
      </tbody>
    </table>

    <div>
      <button id="treadBtn" type="button">transform it!</button>
      
      <button id="tclearBtn" type="button">clear</button>
      <button id="texampleBtn" type="button">transform example</button>
    </div>
  </form>
</div>

<div class="box">
  <h3>output</h3>
  <pre id="output">No matrix read yet.</pre>
<div class="graph">

<canvas id="cans" width="500" height="500" style="border: 1px solid #000;"></canvas>

<script>

      let canvas = document.getElementById('cans');
    let ctx = canvas.getContext('2d');

    //ctx.beginPath();
//darn

  function readMatrix(ty) {
  
 
    const mat = [];
    
    for (let r = 0; r < 3; r++) {
    
      const row = [];
      
      for (let c = 0; c < 3; c++) {
      
      let id = `m${r}${c}`;
      
      if( ty == 1) id = `t${r}${c}`;
      
       
        const el = document.getElementById(id);
        const valStr = el.value.trim();
        
        if (valStr === "") {
          return null;
        }
        
        const v = Number(valStr);
        if (!Number.isFinite(v)) return null;
        row.push(v);
      }
      
      mat.push(row);
      
      
    }
  
   


  return mat;
  }



function drawstuff(mat){

const a = mat[0][0], b = mat[0][1], c = mat[0][2];
    const d = mat[1][0], e = mat[1][1], f = mat[1][2];
    const g = mat[2][0], h = mat[2][1], i = mat[2][2];
  
 ctx.clearRect(0,0, 500,500); 
ctx.beginPath();

ctx.moveTo(250 + a * 10,250 + d * 10);
ctx.lineTo(250 + b * 10,250 + e * 10);
ctx.lineTo(250 + c * 10,250 + f * 10);
ctx.lineTo(250 + a * 10,250 + d * 10);
  
ctx.stroke();  

}


//determinate and shit
  function det3(m) {
   
    const a = m[0][0], b = m[0][1], c = m[0][2];
    const d = m[1][0], e = m[1][1], f = m[1][2];
    const g = m[2][0], h = m[2][1], i = m[2][2];
    return a*(e*i - f*h) - b*(d*i - f*g) + c*(d*h - e*g);

  }

//transpose
  function transpose3(m) {
    const t = [];
    for (let r=0;r<3;r++){ t[r]=[]; for (let c=0;c<3;c++) t[r][c] = m[c][r]; }
    return t;
  }

  function prettyMatrix(m) {
    return m.map(r => '[ ' + r.map(x => Number.isInteger(x) ? x : +x.toFixed(6)).join(', ') + ' ]').join('\n');
  }

  document.getElementById('readBtn').addEventListener('click', () => {
    const mat = readMatrix(0);
    const out = document.getElementById('output');
    if (!mat) {
      out.textContent = 'please fill every field dumbass!';
      return;
    }
    const determinant = det3(mat);
    const t = transpose3(mat);
    out.textContent = 'matrix:\n' + prettyMatrix(mat) + '\n\n' +
                      'transpose:\n' + prettyMatrix(t) + '\n\n' +
                      'determinant: ' + determinant;
                      
                          drawstuff(mat);
                      
                      
                      
                       });
                       
                       
                         document.getElementById('treadBtn').addEventListener('click', () => {
                         
const mat1 = readMatrix();
     const mat2 = readMatrix(1);
    
      const result = [];
      for (let r = 0; r < 3; r++) {
        result[r] = [];
        for (let c = 0; c < 3; c++) {
          result[r][c] = mat1[r][c] * mat2[r][c];
        }
      }
        drawstuff(result);
      return result;
      
      
                       });


  document.getElementById('clearBtn').addEventListener('click', () => {
    for (let r=0;r<3;r++) for (let c=0;c<3;c++) document.getElementById(`m${r}${c}`).value = '';
    document.getElementById('output').textContent = 'gone.';
  });

  document.getElementById('exampleBtn').addEventListener('click', () => {

    const example = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1]
    ];
    for (let r=0;r<3;r++) for (let c=0;c<3;c++) document.getElementById(`m${r}${c}`).value = example[r][c];
    document.getElementById('output').textContent = 'identity.';
  });


 document.getElementById('texampleBtn').addEventListener('click', () => {

    const example = [
      [3, 2, 5],
      [3, 2, 5],
      [0, 0, 1]
    ];
    for (let r=0;r<3;r++) for (let c=0;c<3;c++) document.getElementById(`t${r}${c}`).value = example[r][c];
   
  });

 
  document.querySelectorAll('input[type="number"]').forEach(el =>
    el.addEventListener('keydown', (ev) => {
      if (ev.key === 'Enter') {
        ev.preventDefault();
        document.getElementById('readBtn').click();
      }
    })
  );
</script>
</div>
</div>
</body>
</html>
